// Code generated by valforge. DO NOT EDIT.
// Version: v0.0.3
package valgen

import (
    "encoding/json"
    "fmt"
    "strings"
)

type FieldError struct {
    Field   string      `json:"field"`
    Message string      `json:"message"`
    Value   interface{} `json:"value,omitempty"`
}

func (e FieldError) Error() string {
    return fmt.Sprintf("%s: %s", e.Field, e.Message)
}

type ValidationError struct {
    Struct string       `json:"struct"`
    Errors []error `json:"errors"`
}

func (e *ValidationError) Error() string {
    if len(e.Errors) == 0 {
        return fmt.Sprintf("%s validation failed", e.Struct)
    }

    if len(e.Errors) == 1 {
        return fmt.Sprintf("%s validation failed: %s", e.Struct, e.Errors[0].Error())
    }

    var messages []string
    for _, err := range e.Errors {
        messages = append(messages, err.Error())
    }
    return fmt.Sprintf("%s validation failed: %s", e.Struct, strings.Join(messages, ", "))
}

func (e *ValidationError) AddFieldError(field, message string, value interface{}) {
    e.Errors = append(e.Errors, FieldError{
        Field:   field,
        Message: message,
        Value:   value,
    })
}

func (e *ValidationError) JSON() ([]byte, error) {
    return json.Marshal(e)
}

func (e *ValidationError) HasField(field string) bool {
    for _, f := range e.Errors {
        if f.(FieldError).Field == field {
            return true
        }
    }
    return false
}

func NewValidationError(structName string) *ValidationError {
    return &ValidationError{
        Struct: structName,
    }
}
