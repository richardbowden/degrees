// Code generated by valforge. DO NOT EDIT.
// Version: v0.0.3

package services

import (
    "crypto/subtle"

    valgen "github.com/typewriterco/p402/internal/valgen"
)

func (v NewUser) Validate() error {
    verr := valgen.NewValidationError("NewUser")

    if v.FirstName == "" {
        verr.AddFieldError("first_name", "first_name is required", v.FirstName)
    }
    if len(v.FirstName) < 2 {
        verr.AddFieldError("first_name", "first_name must be at least 2 characters", v.FirstName)
    }

    if len(verr.Errors) > 0 {
        return verr
    }

    return nil
}

func (v NewUserRequest) Validate() error {
    verr := valgen.NewValidationError("NewUserRequest")

    if v.Email == "" {
        verr.AddFieldError("email", "email is required", v.Email)
    }
    err := valgen.ValidateEmail(v.Email)
    if err != nil {
        verr.AddFieldError("email", err.Error(), v.Email)
    }

    if v.FirstName == "" {
        verr.AddFieldError("first_name", "first_name is required", v.FirstName)
    }
    if len(v.FirstName) < 2 {
        verr.AddFieldError("first_name", "first_name must be at least 2 characters", v.FirstName)
    }

    if v.Password1 == "" {
        verr.AddFieldError("pwd1", "pwd1 is required", v.Password1)
    }

    if subtle.ConstantTimeCompare([]byte(v.Password2), []byte(v.Password1)) == 0 {
        verr.AddFieldError("pwd2", "pwd2 must match Password1", v.Password2)
    }

    if len(verr.Errors) > 0 {
        return verr
    }

    return nil
}

